<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Allow indexing -->
  <meta name="robots" content="index, follow" />

  <!-- Google Verification -->
  <meta name="google-site-verification" content="ZuK2pvozDS96vm0_IRjSYEsTqSdC8FJCIgJdAitGf0U" />


 <title>Free Tuition – Free Online Math Tutor Kenya, English Tutor Kenya & Integrated Science Tutor Kenya (Grades 7–9)</title>


  <!-- SEO Meta -->
  <meta name="description" content="Smart Tutor Kenya offers FREE live online tuition for CBC & IGCSE Grades 7–9 in Math, English, and Integrated Science. Join daily lessons in Nairobi, Mombasa, Rift Valley, and across Kenya. Perfect for homeschooling and online learners.">
  <meta name="keywords" content="Smart Tutor Kenya, free online Math tutor Kenya, free online English tutor Kenya, free online Integrated Science tutor Kenya, online tuition Nairobi, online tuition Mombasa, online tuition Rift Valley, CBC tuition Kenya, IGCSE tuition Kenya, homeschooling Kenya, Grade 7 tuition, Grade 8 tuition, Grade 9 tuition, best online tutors Kenya">
  <meta name="author" content="Smart Tutor by Elimu Connect">

  <!-- Open Graph (Social Preview) -->
  <meta property="og:title" content="Smart Tutor – Free Online Math, English & Integrated Science Tuition in Kenya (Grades 7–9)">
  <meta property="og:description" content="Join FREE daily online Math, English, and Integrated Science lessons for CBC & IGCSE Grades 7–9. Available in Nairobi, Mombasa, Rift Valley, and across Kenya. Perfect for homeschooling and online learning.">
  <meta property="og:url" content="https://elimuconnect.github.io/ELIMU-CONNECT-/alessonsbest">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://elimuconnect.github.io/ELIMU-CONNECT-/images/smart-tutor-banner.png">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Smart Tutor – Free Online Math, English & Integrated Science Tuition in Kenya">
  <meta name="twitter:description" content="Daily live Math, English & Integrated Science lessons for CBC & IGCSE Grades 7–9 in Nairobi, Mombasa, Rift Valley, and across Kenya. FREE tuition for all students.">
  <meta name="twitter:image" content="https://elimuconnect.github.io/ELIMU-CONNECT-/images/smart-tutor-banner.png">

  <!-- Structured Data (JSON-LD) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "EducationalOrganization",
    "name": "Smart Tutor",
    "url": "https://elimuconnect.github.io/ELIMU-CONNECT-/alessonsbest",
    "logo": "https://elimuconnect.github.io/ELIMU-CONNECT-/images/smart-tutor-logo.png",
    "description": "Smart Tutor Kenya provides FREE live online tuition for CBC & IGCSE Grades 7–9 in Math, English, and Integrated Science. Lessons available in Nairobi, Mombasa, Rift Valley, and across Kenya. Ideal for homeschooling and online learning.",
    "address": {
      "@type": "PostalAddress",
      "addressCountry": "KE"
    },
    "sameAs": [
      "https://elimuconnect.github.io/ELIMU-CONNECT-/"
    ],
    "department": [
      {
        "@type": "Course",
        "name": "Math Tuition Grade 7-9",
        "description": "Free online Math lessons for CBC & IGCSE students in Nairobi, Mombasa, Rift Valley, and across Kenya."
      },
      {
        "@type": "Course",
        "name": "English Tuition Grade 7-9",
        "description": "Free online English lessons for CBC & IGCSE students in Nairobi, Mombasa, Rift Valley, and across Kenya."
      },
      {
        "@type": "Course",
        "name": "Integrated Science Tuition Grade 7-9",
        "description": "Free online Integrated Science lessons for CBC & IGCSE students in Nairobi, Mombasa, Rift Valley, and across Kenya."
      }
    ]
  }
  </script>
  
<style>
* { box-sizing: border-box; margin:0; padding:0; }
html, body { height:100%; font-family: 'Segoe UI', sans-serif; background:linear-gradient(to right,#e0f7fa,#fce4ec); }
#app { display:flex; flex-direction:column; min-height:100vh; }
#toolbar { display:flex; flex-wrap:wrap; gap:10px; padding:10px; justify-content:center; }
#toolbar button { padding:12px; font-size:16px; border:none; border-radius:8px; background:#4CAF50; color:white; cursor:pointer; flex:1 1 auto; transition:0.3s; }
#toolbar button:hover { background:#45a049; }
@media(max-width:600px){#toolbar{display:grid;grid-template-columns:1fr 1fr;}#toolbar button{width:100%;}}

.card { max-width:90vw; margin:20px auto; padding:20px; background:white; border-radius:20px; border:2px solid #ccc; box-shadow:0 8px 24px rgba(0,0,0,0.15); font-size:1.2em; line-height:1.8; color:#1a237e; }
.card h2{margin-top:0;}
#status{padding:10px; background:#388e3c; color:white; text-align:center; font-weight:bold; font-size:15px;}
.timetable{margin-top:12px;background:#f9fbff;padding:8px;border-radius:8px;box-shadow:0 1px 3px rgba(0,0,0,0.05);}
.timetable table{width:100%;border-collapse:collapse;font-size:0.85em;}
.timetable th{background:#1976d2;color:white;padding:4px 6px;border:1px solid #ccc;}
.timetable td{padding:4px 6px;border:1px solid #ccc;}
.timetable tr:nth-child(even){background:#f1f6fb;}
.rating span{font-size:1.2em; cursor:pointer; user-select:none; transition:color 0.3s;}
.rating span.active{color:gold;}
.rating span.hover{color:orange;}
</style>
</head>
<body>
<div id="app">

<!-- Curriculum Selection -->
<div id="curriculumSelect" style="text-align:center; padding:30px; display:none;">
<h2>📚 Choose Your Curriculum</h2>
<button onclick="chooseCurriculum('CBC')">🇰🇪 CBC (Kenya)</button>
<button onclick="chooseCurriculum('British')">🇬🇧 British Curriculum</button>
<button onclick="chooseCurriculum('CBSE')">🇮🇳 India (CBSE)</button>
</div>

<!-- Main Tutor -->
<div id="mainTutor" style="display:none;">
<div id="toolbar">
<button id="loginBtn">🔑 Google Login</button>
<button onclick="startTutor()">▶️ Start Tutor</button>
<button onclick="pauseTutor()">⏸️ Pause</button>
<button onclick="resumeTutor()">▶️ Resume</button>
<button onclick="prevLesson()">⬅️ Back</button>
<button onclick="nextLesson()">➡️ Next</button>
<button onclick="contactWhatsApp()">💬 Customer Care</button>
</div>

<div id="editor">
<!-- Login Card -->
<div class="card" id="loginCard">
<h2>Welcome to Smart Tutor</h2>
<p>Login with Google to access live Maths lessons (Mon–Sat) with voice narration.</p>
<div class="timetable">
<h3>📅 Weekly Timetable</h3>
<table>
<tr><th>Day</th><th>Subject</th><th>Time</th></tr>
<tr><td>Mon – Fri</td><td>Math</td><td>5:30 PM – 7:00 PM</td></tr>
<tr><td>Saturday</td><td>Math</td><td>8:00 AM – 10:00 AM</td></tr>
<tr><td>Sunday</td><td colspan="2">No lessons scheduled</td></tr>
</table>
</div>
<button id="loginBtn2">🔑 Google Login</button>
</div>

<!-- Tutor Card -->
<div class="card" id="tutorCard" style="display:none;">
<h2>Welcome to Smart Tutor</h2>
<p id="selectedCurriculum"></p>
<div class="rating" id="ratingStars"><span data-v="1">★</span><span data-v="2">★</span><span data-v="3">★</span><span data-v="4">★</span><span data-v="5">★</span></div>
<p id="ratingValue">Average Rating: <span id="avgRating">–</span> ★</p>
<div id="lessonContainer"></div>
<div id="status">⏳ Ready…</div>
</div>
</div>
</div>
</div>

<script src="https://www.gstatic.com/firebasejs/11.0.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/11.0.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/11.0.0/firebase-database-compat.js"></script>

<script>
// Firebase
const firebaseConfig = {apiKey:"AIzaSyCAiOSHmURDyAAYm5EmoomLkZ_Aud7iXIQ",authDomain:"cbc-general.firebaseapp.com",databaseURL:"https://cbc-general-default-rtdb.firebaseio.com",projectId:"cbc-general",storageBucket:"cbc-general.firebasestorage.app",messagingSenderId:"764732839741",appId:"1:764732839741:web:ab829af54839de91359754"};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth(); const db = firebase.database();

let user=null, chosenCurriculum=null, currentLesson=0, todayLessons=[], selectedVoice=null, utter=null;

function googleLogin(){
  const provider = new firebase.auth.GoogleAuthProvider();
  auth.signInWithPopup(provider).then(res=>{
    user=res.user;
    document.getElementById("status").textContent=`👋 Hi ${user.displayName}`;
    db.ref("students/"+user.uid).update({name:user.displayName,email:user.email});
  }).catch(e=>alert(e.message));
}

auth.onAuthStateChanged(u=>{
  user=u;
  const loginCard=document.getElementById("loginCard");
  const curriculumSelect=document.getElementById("curriculumSelect");
  const tutorCard=document.getElementById("tutorCard");
  if(user){ loginCard.style.display="block"; curriculumSelect.style.display="block"; tutorCard.style.display="none"; document.getElementById("loginBtn").style.display="none"; document.getElementById("loginBtn2").style.display="none"; status.textContent=`👋 Hi ${user.displayName}`; } 
  else { loginCard.style.display="block"; curriculumSelect.style.display="none"; tutorCard.style.display="none"; document.getElementById("loginBtn").style.display="inline-block"; document.getElementById("loginBtn2").style.display="inline-block"; status.textContent="Please log in to continue.";}
});

const lessonsArray = {
  CBC: {
    Mon: { Math: [
      `<h2>CBC Lesson 1 — Number Operations</h2><p>Content: Add, subtract, multiply & divide integers.</p>`,
      `<h2>CBC Lesson 2 — Fractions</h2><p>Content: Equivalent fractions, addition & subtraction.</p>`
    ]},
    Tue: { Math: [
      `<h2>CBC Lesson 3 — Decimals</h2><p>Content: Place value, rounding, operations.</p>`
    ]},
    Wed: { Math: [
      `<h2>CBC Lesson 4 — Ratio & Proportion</h2><p>Content: Direct & inverse proportion basics.</p>`
    ]},
    Thu: { Math: [
      `<h2>CBC Lesson 5 — Algebra Basics</h2><p>Content: Expressions, simple equations.</p>`
    ]},
    Fri: { Math: [
      `<h2>CBC Lesson 6 — Geometry Basics</h2><p>Content: Angles, triangles and perimeter.</p>`
    ]},
    Sat: { Math: [
      `<h2>CBC Lesson 7 — Revision & Practice</h2><p>Content: Mixed exercises and quick tests.</p>`
    ]}
  },

  British: {
    Mon: { Math: [
      `<h2>British Lesson 1 — Number Operations</h2><p>Content: Four operations with integers.</p>`
    ]},
    Tue: { Math: [
      `<h2>British Lesson 2 — Fractions</h2><p>Content: Simplifying, comparing, and converting fractions.</p>`
    ]},
    Wed: { Math: [
      `<h2>British Lesson 3 — Decimals</h2><p>Content: Ordering, rounding, and decimal operations.</p>`
    ]},
    Thu: { Math: [
      `<h2>British Lesson 4 — Ratio & Proportion</h2><p>Content: Solving ratio problems and scale drawings.</p>`
    ]},
    Fri: { Math: [
      `<h2>British Lesson 5 — Algebra Basics</h2><p>Content: Substitution, equations, and simple formulae.</p>`
    ]},
    Sat: { Math: [
      `<h2>British Lesson 6 — Geometry</h2><p>Content: Properties of shapes, perimeter, and area.</p>`
    ]}
  },

  CBSE: {
    Mon: { Math: [
      `<h2>Math-Only Lesson 1 — Integers</h2><p>Content: Positive & negative numbers practice.</p>`
    ]},
    Tue: { Math: [
      `<h2>Math-Only Lesson 2 — Fractions</h2><p>Content: Simplifying, adding, subtracting fractions.</p>`
    ]},
    Wed: { Math: [
      `<h2>Math-Only Lesson 3 — Decimals</h2><p>Content: Decimal place value and multiplication.</p>`
    ]},
    Thu: { Math: [
      `<h2>Math-Only Lesson 4 — Ratio</h2><p>Content: Solving ratio and sharing problems.</p>`
    ]},
    Fri: { Math: [
      `<h2>Math-Only Lesson 5 — Algebra</h2><p>Content: Expanding brackets, simple equations.</p>`
    ]},
    Sat: { Math: [
      `<h2>Math-Only Lesson 6 — Geometry</h2><p>Content: Angles in triangles, quadrilaterals.</p>`
    ]}
  }
};




/* ---------- STATIC TIMETABLE (matches your HTML) ---------- */
const timetables = {
  CBC: {
    Mon: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Tue: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Wed: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Thu: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Fri: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Sat: [{ subject: "Math", start: "08:00", end: "10:00" }],
    Sun: []
  },
  British: {
    Mon: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Tue: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Wed: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Thu: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Fri: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Sat: [{ subject: "Math", start: "08:00", end: "10:00" }],
    Sun: []
  },
  CBSE: {
    Mon: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Tue: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Wed: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Thu: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Fri: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Sat: [{ subject: "Math", start: "08:00", end: "10:00" }],
    Sun: []
  }
};

function chooseCurriculum(curriculum) {
  chosenCurriculum = curriculum;

  // Hide curriculum selection
  document.getElementById("curriculumSelect").style.display = "none";

  // Show tutor card (main lessons card)
  document.getElementById("tutorCard").style.display = "block";
  document.getElementById("selectedCurriculum").innerText = "✅ Curriculum: " + curriculum;

  // Start lessons
  startTutor();
}



/* ---------- HELPER: Check if current time is in a slot ---------- */
function inTimeRange(start, end, now){
  const [sH, sM] = start.split(":").map(Number);
  const [eH, eM] = end.split(":").map(Number);
  const startTime = new Date(now); startTime.setHours(sH, sM, 0, 0);
  const endTime = new Date(now); endTime.setHours(eH, eM, 0, 0);
  return now >= startTime && now <= endTime;
}



/* ---------- VOICE ---------- */
function getVoice(){
  const voices = speechSynthesis.getVoices();
  return voices.find(v=>v.lang.startsWith("en-ke") && v.name.toLowerCase().includes("female"))
         || voices.find(v=>v.lang.startsWith("en-ke"))
         || voices.find(v=>v.lang.startsWith("en-gb"))
         || voices[0];
}

function speak(html){
  const tmp = document.createElement("div");
  tmp.innerHTML = html;
  speechSynthesis.cancel();
  utter = new SpeechSynthesisUtterance(tmp.textContent);
  utter.voice = selectedVoice;
  utter.rate = 0.8;
  speechSynthesis.speak(utter);
}


/* ---------- START TUTOR ---------- */
function startTutor() {
  if (!chosenCurriculum) {
    alert("⚠️ Please select your curriculum first.");
    return;
  }

  // ✅ Kenya time
  const now = new Date();
  const kenyaTime = new Date(now.toLocaleString("en-US", { timeZone: "Africa/Nairobi" }));

  const days = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
  const todayName = days[kenyaTime.getDay()];

  // ✅ Use timetable for chosen curriculum
  const slots = timetables[chosenCurriculum]?.[todayName] || [];

  // ✅ Only allow Math lessons
  const currentSlot = slots.find(slot => 
    slot.subject === "Math" && inTimeRange(slot.start, slot.end, kenyaTime)
  );

  if (!currentSlot) {
    if (editor) {
      editor.innerHTML = `
        <div class="card">
          <h2>⏳ No active Math lesson right now. Check the timetable.</h2>
        </div>
      `;
    }
    if (status) status.textContent = "No active Math lesson";
    return;
  }

  // ✅ Load Math lessons
  todayLessons = lessonsArray[chosenCurriculum]?.[todayName]?.Math || [
    `<div><h2>Math Lesson</h2><p>Lesson coming soon.</p></div>`
  ];

  // ✅ Wait for voice to be ready
  const waitVoices = setInterval(() => {
    if (speechSynthesis.getVoices().length) {
      clearInterval(waitVoices);
      selectedVoice = getVoice();
      currentLesson = 0;
      showLesson();
    }
  }, 100);
}

  
// --- Full Features List ---
const appFeatures = [
  "🎓 Affordable Live Online Tuition – From just Ksh 200 per hour",
  "👩‍🏫 Live group tuition with real tutors from top Kenyan schools",
  "🤖 FREE AI-Powered Virtual Tutor – 24/7 homework & exam help",
  "📲 Connect with nearby tutors for physical or online tuition",
  "📝 On-Demand Homework Help with AI + human tutors",
  "💬 Free student academic chats & forums across Kenya",
  "📚 Access 2000+ Video Lessons & 5000+ Quizzes",
  "📖 30,000+ CBC, IGCSE & KCSE Past Papers with Answers",
  "📘 200+ Ebooks for Primary & Secondary Students",
  "🏆 Weekly National Tests & Digital Certificates",
  "❓ 1000+ Question & Answer Pairs from Past Exams",
  "🎮 3 Fun Math Games & 3 Kiswahili/English Language Games",
  "🌍 Career Guidance Tools for Kenyan Teens",
  "🗓️ AI-Powered Study Timetable Generator",
  "📝 Digital Notebook, Notes Organizer & Revision Tracker",
  "🧮 Scientific Calculator + Graph Plotting Tools",
  "🔢 Math, Chemistry & Physics Formula Tools",
  "📖 Digital Dictionary & Kiswahili Kamusi",
  "💡 Similes, Metaphors, Methali & Nahau Reference Tools",
  "🧍‍♂️ Human, Fish & Plant 3D Anatomy Simulators",
  "🧪 Interactive Digital Periodic Table",
  "⚛️ Physics Concepts & Mole Calculators",
  "🧬 Chemical Equations Balancer + Organic Chemistry Guide",
  "📐 Math Tools: Area, Volume, Trigonometry, Logarithms",
  "💰 Financial Math Tools: Tax, Interest, Binomial, Variation",
  "🗺️ Geography Tools: Latitude/Longitude, Errors & Approximations",
  "📊 Advanced Statistics & Matrix Solvers",
  "➗ Calculus: Differentiation & Integration Calculators"
];

let featureIndex = 0;

/* ---------- SHOW CURRENT LESSON ---------- */
function showLesson() {
  if (!todayLessons || todayLessons.length === 0) {
    editor.innerHTML = `
      <div class="card">
        <h2>📌 No lessons available for ${chosenCurriculum} today.</h2>
        <p>Please check the timetable or come back later.</p>
      </div>
    `;
    return;
  }

  if (currentLesson >= todayLessons.length) {
    editor.innerHTML = `
      <div class="card">
        <h2>✅ All lessons for this slot are done!</h2>
        <p>Keep learning with <b>Smart Tutor by Elimu Connect</b>.</p>
      </div>
    `;
    return;
  }

  const lessonHtml = todayLessons[currentLesson];

  // 🔄 Pick 3 rotating app features
  const f1 = appFeatures[featureIndex % appFeatures.length];
  const f2 = appFeatures[(featureIndex + 1) % appFeatures.length];
  const f3 = appFeatures[(featureIndex + 2) % appFeatures.length];
  featureIndex += 3;

  // 🎨 Render lesson card
  editor.innerHTML = `
    <div class="card">
      <h3>${chosenCurriculum} – Math</h3>
      ${lessonHtml}
      <hr>
      <div style="margin-top:10px; background:#f0f8ff; padding:10px; border-radius:10px; font-size:0.9em;">
        <b>📲 More with Elimu Connect App:</b>
        <ul style="margin:5px 0; padding-left:20px;">
          <li>${f1}</li>
          <li>${f2}</li>
          <li>${f3}</li>
        </ul>
        <a href="https://play.google.com/store/apps/details?id=elimuconnect.tuitioncentre" target="_blank">
          <button style="background:#28a745;color:white;padding:8px 12px;border:none;border-radius:6px;cursor:pointer;font-size:14px;">
            🚀 Install App
          </button>
        </a>
      </div>
    </div>
  `;

  // 🔊 Speak lesson content
  speak(lessonHtml);
}

  
// Realtime Database reference


const ratingStars = document.querySelectorAll(".rating span");
const avgRatingEl = document.getElementById("avgRating");

// Add a container for the delayed message
let ratingTimeout;
let ratingMessage = document.getElementById("ratingMessage");
if (!ratingMessage) {
  ratingMessage = document.createElement("div");
  ratingMessage.id = "ratingMessage";
  ratingMessage.style.cssText = `
    display:none; 
    color:#388e3c; 
    font-weight:bold; 
    margin-bottom:10px; 
    opacity:0; 
    transform:translateY(-10px); 
    transition: all 0.5s ease;
  `;
  document.querySelector(".card").prepend(ratingMessage);
}

// --- Visual star update (clicked/persisted) --- //
function updateStars(val) {
  ratingStars.forEach(s => {
    s.classList.remove("active");
    if (parseInt(s.dataset.v) <= val) {
      s.classList.add("active");
    }
  });
}

// --- Function to update average rating live --- //
function updateAverageRating() {
  db.ref("ratings").on("value", snapshot => {
    let total = 0, count = 0;
    snapshot.forEach(child => {
      total += child.val().rating;
      count++;
    });

    const avg = count ? (total / count).toFixed(1) : 0;

    // Update the display with average and number of ratings
    avgRatingEl.textContent = count 
      ? `${avg} (${count} students)` 
      : "No ratings yet";
  });
}

// Call it once to start listening for live updates
updateAverageRating();

// --- Hover preview only --- //
ratingStars.forEach(star => {
  star.addEventListener("mouseover", () => {
    const val = parseInt(star.dataset.v);
    ratingStars.forEach(s => {
      s.classList.toggle("hover", parseInt(s.dataset.v) <= val);
    });
  });

  star.addEventListener("mouseout", () => {
    ratingStars.forEach(s => s.classList.remove("hover"));
    if (user) {
      db.ref("students/" + user.uid).once("value", snap => {
        const val = snap.exists() ? snap.val().rating : 0;
        updateStars(val);
      });
    } else {
      updateStars(0); // keep gray when not logged in
    }
  });
});

// --- Click events to save rating --- //
ratingStars.forEach(star => {
  star.addEventListener("click", async () => {
    if (!user) return alert("⚠️ Login first to save rating.");
    const val = parseInt(star.dataset.v);

    // Save/update user's rating inside student profile
    await db.ref("students/" + user.uid).update({
      name: user.displayName,
      email: user.email,
      rating: val,
      ratingTimestamp: Date.now()
    });

    // Also save/update inside ratings node for averaging
    await db.ref("ratings/" + user.uid).set({
      rating: val,
      timestamp: Date.now()
    });

    // Update stars visually for this user
    updateStars(val);

    // Clear previous timeout if any
    if (ratingTimeout) clearTimeout(ratingTimeout);

    // Delay message 5 seconds
    ratingTimeout = setTimeout(() => {
      ratingMessage.textContent = `Thanks! You rated ${val}⭐`;
      ratingMessage.style.display = "block";
      setTimeout(() => {
        ratingMessage.style.opacity = 1;
        ratingMessage.style.transform = "translateY(0)";
      }, 10);

      // Fade out after 3s
      setTimeout(() => {
        ratingMessage.style.opacity = 0;
        ratingMessage.style.transform = "translateY(-10px)";
        setTimeout(() => { ratingMessage.style.display = "none"; }, 500);
      }, 3000);

      ratingTimeout = null;
    }, 5000);
  });
});

// --- Restore student’s rating after login --- //
auth.onAuthStateChanged(u => {
  user = u;
  if (user) {
    db.ref("ratings/" + user.uid).once("value", snap => {
      if (snap.exists()) updateStars(snap.val().rating);
      else updateStars(0);
    });
  } else {
    updateStars(0);
  }
});



  
function savePhoneNumber() {
  const phone = document.getElementById("phoneInput").value.trim();
  if (!phone) {
    alert("⚠️ Please enter your phone number.");
    return;
  }

  db.ref("students/" + user.uid).update({
    phone: phone,
    timestamp: Date.now()
  }).then(() => {
    alert("✅ Phone number saved! Lessons unlocked.");
    document.getElementById("phoneForm").style.display = "none";
    document.querySelector(".card").style.display = "block";
    editor.scrollIntoView({behavior: "smooth"});
  });
}





/* ---------- LESSON NAVIGATION ---------- */
function prevLesson() {
  if (todayLessons && todayLessons.length && currentLesson > 0) {
    currentLesson--;
    showLesson();
  } else {
    status.textContent = "⏮️ Already at the first lesson.";
  }
}

function nextLesson() {
  if (todayLessons && todayLessons.length && currentLesson < todayLessons.length - 1) {
    currentLesson++;
    showLesson();
  } else {
    status.textContent = "⏭️ No more lessons in this slot.";
  }
}

/* ---------- VOICE CONTROLS ---------- */
function pauseTutor() {
  if (speechSynthesis.speaking) {
    speechSynthesis.pause();
    status.textContent = "⏸️ Paused";
  }
}

function resumeTutor() {
  if (speechSynthesis.paused) {
    speechSynthesis.resume();
    status.textContent = "▶️ Resumed";
  }
}

/* ---------- CONTACT SUPPORT ---------- */
function contactWhatsApp() {
  window.open("https://wa.me/254769255782", "_blank");
}

function saveLessonRequest() {
  if (!user) {
    alert("⚠️ Please login first to request a lesson.");
    return;
  }

  const requestText = document.getElementById("lessonRequest").value.trim();
  const statusEl = document.getElementById("requestStatus");

  if (!requestText) {
    statusEl.textContent = "❌ Please type your lesson request before submitting.";
    statusEl.style.color = "red";
    return;
  }

  // Save request under student node → append new requests
  const requestsRef = db.ref("students/" + user.uid + "/requests").push();

  requestsRef.set({
    text: requestText,
    timestamp: Date.now()
  }).then(() => {
    statusEl.textContent = "✅ Your request has been saved!";
    statusEl.style.color = "green";
    document.getElementById("lessonRequest").value = "";
  }).catch(err => {
    statusEl.textContent = "❌ Error: " + err.message;
    statusEl.style.color = "red";
  });
}


  
</script>
</body>
</html>
