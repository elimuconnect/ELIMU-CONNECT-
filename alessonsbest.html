<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Allow indexing -->
  <meta name="robots" content="index, follow" />

  <!-- Google Verification -->
  <meta name="google-site-verification" content="ZuK2pvozDS96vm0_IRjSYEsTqSdC8FJCIgJdAitGf0U" />

<title>Free Online Math Tuition – Smart Tutor by Elimu Connect / SmartLearn (Grades 7–12)</title>

<!-- SEO Meta -->
<meta name="description" content="Smart Tutor by Elimu Connect / SmartLearn offers FREE live online Math lessons for CBC, British (IGCSE/GCSE), and Indian curricula (CBSE, ICSE, IB) for Grades 7–12. Join daily lessons from anywhere in Kenya and beyond. Perfect for homeschooling and online learners.">
<meta name="keywords" content="Smart Tutor Kenya, free online Math tutor Kenya, CBC Math tuition Kenya, IGCSE Math tuition Kenya, CBSE Math tuition India, online Math lessons Kenya, homeschooling Math Kenya, Grade 7 Math, Grade 8 Math, Grade 9 Math, Grade 10 Math, Grade 11 Math, Grade 12 Math, best online Math tutors">
<meta name="author" content="Smart Tutor by Elimu Connect / SmartLearn">

<!-- Open Graph (Social Preview) -->
<meta property="og:title" content="Smart Tutor – Free Online Math Tuition by Elimu Connect / SmartLearn (Grades 7–12)">
<meta property="og:description" content="Join FREE live online Math lessons for CBC, British (IGCSE/GCSE), and Indian curricula (CBSE, ICSE, IB) for Grades 7–12. Available in Kenya and online globally. Perfect for homeschooling and online learning.">
<meta property="og:url" content="https://elimuconnect.github.io/ELIMU-CONNECT-/alessonsbest">
<meta property="og:type" content="website">
<meta property="og:image" content="https://elimuconnect.github.io/ELIMU-CONNECT-/images/smart-tutor-banner.png">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Smart Tutor – Free Online Math Tuition by Elimu Connect / SmartLearn (Grades 7–12)">
<meta name="twitter:description" content="Daily live Math lessons for CBC, British (IGCSE/GCSE), and Indian curricula (CBSE, ICSE, IB) for Grades 7–12. FREE tuition for all students.">
<meta name="twitter:image" content="https://elimuconnect.github.io/ELIMU-CONNECT-/images/smart-tutor-banner.png">

<!-- Structured Data (JSON-LD) -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "EducationalOrganization",
  "name": "Smart Tutor by Elimu Connect / SmartLearn",
  "url": "https://elimuconnect.github.io/ELIMU-CONNECT-/alessonsbest",
  "logo": "https://elimuconnect.github.io/ELIMU-CONNECT-/images/smart-tutor-logo.png",
  "description": "Smart Tutor by Elimu Connect / SmartLearn provides FREE live online Math lessons for CBC, British (IGCSE/GCSE), and Indian curricula (CBSE, ICSE, IB) for Grades 7–12. Lessons available online across Kenya and globally. Ideal for homeschooling and online learning.",
  "address": {
    "@type": "PostalAddress",
    "addressCountry": "KE"
  },
  "sameAs": [
    "https://elimuconnect.github.io/ELIMU-CONNECT-/"
  ],
  "department": [
    {
      "@type": "Course",
      "name": "Math Tuition Grade 7-12",
      "description": "Free online Math lessons for CBC, British (IGCSE/GCSE), and Indian curricula (CBSE, ICSE, IB) students in Kenya and online globally."
    }
  ]
}
</script>

  
<style>
* { box-sizing: border-box; }
html, body {
  margin: 0; padding: 0; height: 100%;
  font-family: 'Segoe UI', sans-serif;
  background: linear-gradient(to right,#e0f7fa,#fce4ec);
}
#app { display: flex; flex-direction: column; height: 100vh; }
#toolbar {
  padding: 15px;
  background: #1976d2;
  color: white;
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 12px;
}
#toolbar button {
  background: white;
  color: #1976d2;
  padding: 12px 20px;
  border: none;
  border-radius: 30px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
  transition: 0.3s ease;
}
#toolbar button:hover { background: #f0f0f0; }
#editor {
  flex: 1;
  padding: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
}
/* ✅ NEW CARD STYLE */
.card {
  max-width: 90vw;
  width: 100%;
  margin: 20px auto;
  padding: 40px;
  background: white;
  border-radius: 25px;
  border: 2px solid #ccc; /* Added border for prominence */
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
  font-size: 1.8em;
  line-height: 2;
  font-weight: bold;
  animation: fadeIn 1s ease;
  overflow-wrap: break-word;
  word-break: break-word;
  color: #1a237e;
  box-sizing: border-box;
  transition: all 0.3s ease-in-out; /* Smooth hover or layout changes */
}

/* Headings inside cards */
.card h2 {
  margin-top: 0;
  font-size: 2em;
  font-weight: bold;
}

/* Optional manual title colors */
.card h2.red    { color: #d81b60; }
.card h2.green  { color: #2e7d32; }
.card h2.blue   { color: #1565c0; }
.card h2.orange { color: #ef6c00; }
.card h2.purple { color: #6a1b9a; }

/* Automatic color cycling for h2s inside cards */
.card h2:nth-child(5n+1) { color: #d81b60; }
.card h2:nth-child(5n+2) { color: #2e7d32; }
.card h2:nth-child(5n+3) { color: #1565c0; }
.card h2:nth-child(5n+4) { color: #ef6c00; }
.card h2:nth-child(5n+5) { color: #6a1b9a; }

.card pre {
  white-space: pre-wrap;
  overflow-wrap: break-word;
  word-break: break-word;
  font-size: 1.6em;
  line-height: 2;
  font-weight: bold;
  color: #1a237e;
}

#status {
  padding: 15px;
  background: #388e3c;
  color: white;
  font-weight: bold;
  text-align: center;
  font-size: 16px;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to   { opacity: 1; transform: translateY(0); }
}

 #toolbar {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    padding: 10px;
    justify-content: center;
  }

  #toolbar button {
    padding: 12px;
    font-size: 16px;
    border: none;
    border-radius: 8px;
    background: #4CAF50;
    color: white;
    cursor: pointer;
    flex: 1 1 auto;
  }

  #toolbar button:hover {
    background: #45a049;
  }

  /* On phones → 2 columns */
  @media (max-width: 600px) {
    #toolbar {
      display: grid;
      grid-template-columns: 1fr 1fr;
    }

    #toolbar button {
      width: 100%;
    }
  }

  .card {
    padding: 20px;
    font-size: 1.2em;
  }

  .card h2 {
    font-size: 1.4em;
  }

  .card pre {
    font-size: 1.15em;
  }

  #status {
    font-size: 15px;
    padding: 10px;
  }
}

/* Extra formatting helpers for lesson text */
.lesson-title {
  color: #d32f2f; /* Deep red */
  font-size: 1.2em;
  display: block;
  margin: 10px 0;
}
.subtopic {
  color: #1976d2; /* Blue */
  font-weight: bold;
  display: block;
  margin-top: 15px;
}
.question {
  color: #f57c00; /* Orange */
  font-weight: bold;
  display: block;
  margin-top: 15px;
}
.answer {
  color: #388e3c; /* Green */
  font-weight: bold;
  display: block;
  margin-top: 15px;
}
.bullet {
  color: #6a1b9a; /* Purple dot */
  margin-right: 8px;
}
.point {
  color: #1a237e;
  display: block;
  margin-left: 20px;
}

.rating {
  margin-top: 20px;
  font-size: 2em;
  color: #ccc;            /* Default gray */
  display: inline-block;
  cursor: pointer;
  user-select: none;
}


.rating span {
  display: inline-block;       /* ensures each star is separate */
  width: 1.2em;                /* adjust to your star size */
  text-align: center;           /* center the star inside its box */
  transition: color 0.3s;
  user-select: none;
}

  .rating {
  touch-action: manipulation;  /* prevents mobile from interpreting swipe/zoom */
}

  .rating span {
  line-height: 1;  /* prevents vertical area being counted as clickable */
}

  
.rating span.active {
  color: gold;   /* clicked/persisted stars */
}
.rating span.hover {
  color: orange; /* temporary preview */
}


  .timetable {
  margin-top: 12px;
  background: #f9fbff;
  padding: 8px;
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.05);
}

.timetable h3 {
  margin: 0 0 6px;
  color: #1976d2;
  font-size: 1em;
}

.timetable table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.85em; /* smaller font */
}

.timetable th {
  background: #1976d2;
  color: white;
  padding: 4px 6px; /* reduced padding */
  text-align: left;
  border: 1px solid #ccc;
}

.timetable td {
  padding: 4px 6px; /* reduced padding */
  border: 1px solid #ccc;
}

.timetable tr:nth-child(even) {
  background: #f1f6fb;
}

</style>
</head>
  <body>

<div id="app">

<!-- Welcome / Hero Section -->
<div id="welcomeSection" style="text-align:center; margin:30px auto; max-width:700px; padding:20px; background:linear-gradient(to right,#e0f7fa,#fce4ec); border-radius:20px; box-shadow:0 8px 20px rgba(0,0,0,0.1);">
  <h1 style="font-size:2.2em; color:#1976d2; margin-bottom:10px;">🎓 Welcome to Smart Tutor!</h1>
  <p style="font-size:1.1em; color:#333; line-height:1.6;">
    Learn Math the <b>fun, interactive, and easy way</b> – completely <b>FREE</b>!  
    Smart Tutor by <b>Elimu Connect / SmartLearn</b> offers guided lessons, practice exercises, and a personalized weekly timetable for Grades 7-12.
  </p>
  <p style="font-size:1.05em; color:#d32f2f; font-weight:bold; margin-top:15px;">
    Start your journey today and boost your Math skills from home! 🚀
  </p>
</div>


  <!-- Curriculum Selection -->
  <div id="curriculumSelect" style="text-align:center; margin-bottom:20px;">
    <h2>📚 Choose Your Math Curriculum</h2>
    <button onclick="chooseCurriculum('CBC')" style="margin:5px; padding:8px 15px;">🇰🇪 CBC(7-12)</button>
    <button onclick="chooseCurriculum('British')" style="margin:5px; padding:8px 15px;">🇬🇧 British, IGCSE,GCSE(7-12)</button>
    <button onclick="chooseCurriculum('CBSE')" style="margin:5px; padding:8px 15px;">🇮🇳 CBSE, ICSE, IGCSE, IB,(7-12)</button>
  </div>

  <!-- Main Tutor Section -->
  <div id="mainTutor" style="display:none;">

    <!-- Toolbar -->
    <div id="toolbar" style="text-align:center; margin-bottom:15px;">
      <button id="loginBtn">🔑 Google Login</button>
      <button onclick="startTutor()">▶️ Start Tutor</button>
      <button onclick="pauseTutor()">⏸️ Pause</button>
      <button onclick="resumeTutor()">▶️ Resume</button>
      <button onclick="prevLesson()">⬅️ Back</button>
      <button onclick="nextLesson()">➡️ Next</button>
      <button onclick="contactWhatsApp()">💬 Customer Care</button>
    </div>

    <!-- Editor / Lesson Container -->
    <div id="editor">

      <!-- Phone Form -->
      <div id="phoneForm" style="display:none; text-align:center; padding:20px; margin-bottom:20px; border:1px solid #ccc; border-radius:10px; background:#f9f9f9;">
        <h2>📱 Enter Your Phone Number</h2>
        <p id="studentName"></p>
        <input type="text" id="phoneInput" placeholder="e.g. 07xx xxx xxx" style="padding:10px; font-size:1em; width:80%; max-width:300px; border:1px solid #aaa; border-radius:6px;">
        <br><br>
        <button onclick="savePhoneNumber()" style="padding:10px 20px; font-size:1em; border:none; border-radius:8px; background:#1976d2; color:white; cursor:pointer;">
          Save & Unlock Lessons
        </button>
      </div>

      <!-- Main Tutor Card -->
      <div class="card" style="padding:15px; border-radius:10px; background:#fff; box-shadow:0 2px 6px rgba(0,0,0,0.1);">

        <!-- Rating message container -->
        <div id="ratingMessage" style="display:none; color:#388e3c; font-weight:bold; margin-bottom:10px; opacity:0; transform:translateY(-10px); transition: all 0.5s ease;"></div>

        <h2>Welcome to Smart Math Tutor</h2>
        <p id="selectedCurriculum">Please select a curriculum above to start your Math lessons.</p>

        <!-- Weekly Math Timetable -->
        <div class="timetable" style="margin-top:15px;">
          <h3>📅 Weekly Math Timetable (Kenya time)</h3>
          <table style="width:100%; border-collapse:collapse;">
            <thead>
              <tr>
                <th style="border:1px solid #ccc; padding:5px;">Day</th>
                <th style="border:1px solid #ccc; padding:5px;">Time</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>Mon – Fri</td><td>5:30 PM – 7:00 PM</td></tr>
              <tr><td>Saturday</td><td>8:00 AM – 10:00 AM</td></tr>
              <tr><td>Sunday</td><td>No Math lessons scheduled</td></tr>
            </tbody>
          </table>
        </div>

        <!-- Rating -->
        <div class="rating" id="ratingStars" style="margin-top:15px;">
          <p style="font-size:0.6em; margin:5px 0;">Rate this Tutor:</p>
          <span data-v="1">★</span>
          <span data-v="2">★</span>
          <span data-v="3">★</span>
          <span data-v="4">★</span>
          <span data-v="5">★</span>
        </div>
        <p id="ratingValue" style="font-size:0.6em;color:#1976d2;margin-top:6px;">
          Average Rating: <span id="avgRating">–</span> ★
        </p>

        <!-- Lesson Request -->
        <div style="margin-top:20px; padding:10px; border-top:1px solid #ddd;">
          <h3>✍️ Request Math Lessons we should include next week</h3>
          <textarea id="lessonRequest" placeholder="e.g CBC -algebra, Expanding expressions…" style="width:100%; height:80px; border-radius:6px; border:1px solid #aaa; padding:8px; font-size:0.9em;"></textarea>
          <br><br>
          <button onclick="saveLessonRequest()" style="background:#28a745;color:white;padding:10px 15px;border:none;border-radius:6px;cursor:pointer;">
            🚀 Submit Request
          </button>
          <p id="requestStatus" style="font-size:0.8em; margin-top:8px; font-weight:bold;"></p>
        </div>

        <!-- Lesson content container -->
        <div id="lessonContainer" style="margin-top:15px;"></div>
        <div id="status" style="margin-top:10px;">⏳ Ready…</div>

      </div>
    </div>
  </div>
</div>


<script src="https://www.gstatic.com/firebasejs/11.0.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/11.0.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/11.0.0/firebase-database-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyCAiOSHmURDyAAYm5EmoomLkZ_Aud7iXIQ",
  authDomain: "cbc-general.firebaseapp.com",
  databaseURL: "https://cbc-general-default-rtdb.firebaseio.com",
  projectId: "cbc-general",
  storageBucket: "cbc-general.firebasestorage.app",
  messagingSenderId: "764732839741",
  appId: "1:764732839741:web:ab829af54839de91359754"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
/* -------------------------------------- */

const editor = document.getElementById("editor");
const status = document.getElementById("status");
const loginBtn = document.getElementById("loginBtn");

let user = null;

loginBtn.onclick = () => {
  auth.signInWithPopup(new firebase.auth.GoogleAuthProvider())
    .then(res => {
      user = res.user;
      status.textContent = `👋 Hi ${user.displayName}`;

      // Save/update user profile in database
      db.ref("students/" + user.uid).update({
        name: user.displayName,
        email: user.email
      });

      // Check if phone exists
      db.ref("students/" + user.uid).once("value").then(snap => {
        if (!snap.exists() || !snap.val().phone) {
          // Show phone number form
          document.getElementById("studentName").textContent =
            `Welcome ${user.displayName}, please enter your phone number:`;
          document.getElementById("phoneForm").style.display = "block";

          // Hide tutor card while phone is not saved
          document.querySelector(".card").style.display = "none";
        } else {
          // Phone exists, show main tutor card
          document.getElementById("phoneForm").style.display = "none";
          document.querySelector(".card").style.display = "block";
        }
      });
    })
    .catch(e => alert(e.message));
};

// Handle page reload: keep user logged in and check phone
auth.onAuthStateChanged(u => {
  user = u;
  if (user) {
    status.textContent = `👋 Hi ${user.displayName}`;

    db.ref("students/" + user.uid).once("value").then(snap => {
      if (!snap.exists() || !snap.val().phone) {
        document.getElementById("studentName").textContent =
          `Welcome ${user.displayName}, please enter your phone number:`;
        document.getElementById("phoneForm").style.display = "block";
        document.querySelector(".card").style.display = "none";
      } else {
        document.getElementById("phoneForm").style.display = "none";
        document.querySelector(".card").style.display = "block";
      }
    });
  } else {
    // User logged out
    status.textContent = "Please login to start tutoring.";
    document.getElementById("phoneForm").style.display = "none";
    document.querySelector(".card").style.display = "block";
  }
});


let selectedCurriculum = null;
let selectedGrade = null;
let currentLesson = 0;
let todayLessons = [];
let selectedVoice = null;
let utter = null;
let lessonIntervalId = null;
let featureIndex = 0;

/* ---------- Curriculum Selection ---------- */
function chooseCurriculum(curr) {
  selectedCurriculum = curr;

  // Hide the welcome section when a curriculum is chosen
  const welcome = document.getElementById("welcomeSection");
  if (welcome) welcome.style.display = "none";

  // Replace curriculum selection with grade buttons
  document.getElementById("curriculumSelect").innerHTML = `
    <h2>🎓 Choose Your Grade (${curr} Curriculum)</h2>
    ${[7,8,9,10,11,12].map(g=>`<button onclick="chooseGrade(${g})">Grade ${g}</button>`).join('')}
  `;
}


/* ---------- Grade Selection ---------- */
function chooseGrade(g) {
  selectedGrade = g;
  document.getElementById("curriculumSelect").style.display = "none";
  document.getElementById("mainTutor").style.display = "block";
  document.getElementById("selectedCurriculum").textContent = `📘 ${selectedCurriculum} – Grade ${g}`;
  startLessonChecker();
}

/* ---------- Lessons (Math Only) ---------- */
const lessonsArray = {
CBC: {
  7: { // ✅ Grade 7
    Mon: { Math: [
      `<span style="color:purple;"><b>Lesson 8: Fractions and Mixed Numbers</b></span><br><br>

<span style="color:green;"><b>Lesson Content:</b></span><br><br>

A <b>fraction</b> represents a part of a whole. It is written as a/b, where 'a' is the numerator and 'b' is the denominator.<br>
A <b>mixed number</b> combines a whole number and a fraction, e.g., 2 1/3.<br><br>

<b>Examples:</b><br>
- Fraction: 3/4 means 3 parts out of 4.<br>
- Mixed number: 1 2/5 = 1 + 2/5.<br><br>

<span style="color:orange;"><b>Question:</b></span><br>
Convert 7/4 into a mixed number.<br><br>

<span style="color:blue;"><b>Final Answer:</b></span><br>
7/4 = 1 3/4.<br>
`,

`<span style="color:purple;"><b>Lesson 9: Decimals and Percentages</b></span><br><br>

<span style="color:green;"><b>Lesson Content:</b></span><br><br>

Decimals are fractions written with a decimal point. Percentages are parts per 100.<br><br>

<b>Examples:</b><br>
- Decimal: 0.75 = 75/100 = 75%<br>
- Percentage: 40% = 40/100 = 0.4<br><br>

<span style="color:orange;"><b>Question:</b></span><br>
Convert 0.65 to a percentage.<br><br>

<span style="color:blue;"><b>Final Answer:</b></span><br>
0.65 = 65%<br>
`,

`<span style="color:purple;"><b>Lesson 10: Algebraic Expressions</b></span><br><br>

<span style="color:green;"><b>Lesson Content:</b></span><br><br>

An <b>algebraic expression</b> is a combination of numbers, variables, and operations.<br>
- Terms are separated by + or - signs.<br>
- Coefficient is the number multiplying a variable.<br><br>

<b>Examples:</b><br>
- 3x + 5y - 7<br>
- -2a + 4b + 6<br><br>

<span style="color:orange;"><b>Question:</b></span><br>
Identify the coefficient of x in 7x - 3y + 5.<br><br>

<span style="color:blue;"><b>Final Answer:</b></span><br>
Coefficient of x = 7.<br>
`,

`<span style="color:purple;"><b>Lesson 11: Solving Linear Equations</b></span><br><br>

<span style="color:green;"><b>Lesson Content:</b></span><br><br>

A linear equation has the form ax + b = c. Solve by isolating x.<br><br>

<b>Examples:</b><br>
- 2x + 5 = 13 → 2x = 8 → x = 4<br>
- 3x - 7 = 8 → 3x = 15 → x = 5<br><br>

<span style="color:orange;"><b>Question:</b></span><br>
Solve: 5x - 10 = 15<br><br>

<span style="color:blue;"><b>Final Answer:</b></span><br>
5x = 25 → x = 5<br>
`,

`<span style="color:purple;"><b>Lesson 12: Geometry – Angles</b></span><br><br>

<span style="color:green;"><b>Lesson Content:</b></span><br><br>

Angles are formed when two rays meet at a vertex.<br>
- Types: acute (<90°), right (90°), obtuse (>90° but <180°), straight (180°).<br><br>

<b>Examples:</b><br>
- A right angle: 90°<br>
- An obtuse angle: 120°<br><br>

<span style="color:orange;"><b>Question:</b></span><br>
Classify an angle of 140°.<br><br>

<span style="color:blue;"><b>Final Answer:</b></span><br>
140° is an obtuse angle.<br>
`,

`<span style="color:purple;"><b>Lesson 13: Perimeter and Area</b></span><br><br>

<span style="color:green;"><b>Lesson Content:</b></span><br><br>

Perimeter is the total length around a shape. Area is the space inside a shape.<br><br>

<b>Examples:</b><br>
- Rectangle: perimeter = 2(l + w), area = l × w<br>
- Triangle: perimeter = sum of sides, area = 1/2 × base × height<br><br>

<span style="color:orange;"><b>Question:</b></span><br>
Find the area of a rectangle with length 8 cm and width 5 cm.<br><br>

<span style="color:blue;"><b>Final Answer:</b></span><br>
Area = 8 × 5 = 40 cm²<br>
`,

`<span style="color:purple;"><b>Lesson 14: Introduction to Statistics</b></span><br><br>

<span style="color:green;"><b>Lesson Content:</b></span><br><br>

Statistics is the study of collecting, organizing, and interpreting data.<br>
- Mean: average value<br>
- Median: middle value<br>
- Mode: most frequent value<br><br>

<b>Examples:</b><br>
- Data: 2, 4, 4, 6, 8 → Mean = (2+4+4+6+8)/5 = 4.8<br>
- Median = 4, Mode = 4<br><br>

<span style="color:orange;"><b>Question:</b></span><br>
Find the mean of 3, 5, 7, 9, 11<br><br>

<span style="color:blue;"><b>Final Answer:</b></span><br>
Mean = (3+5+7+9+11)/5 = 35/5 = 7<br>
`,

      `<h2>CBC Grade 7 Lesson 2 — Fractions</h2>
       <p>Identify equivalent fractions, simplify fractions, and perform addition and subtraction.</p>`
    ]},
    Tue: { Math: [
      `<h2>CBC Grade 7 Lesson 3 — Decimals</h2>
       <p>Understand place value in decimals, rounding off, and performing the four operations.</p>`,

      `<h2>CBC Grade 7 Lesson 4 — Relationship between Fractions and Decimals</h2>
       <p>Convert between fractions, decimals, and percentages.</p>`
    ]},
    Wed: { Math: [
      `<h2>CBC Grade 7 Lesson 5 — Percentages</h2>
       <p>Find percentages of quantities and solve real-life problems involving discounts and profit.</p>`,

      `<h2>CBC Grade 7 Lesson 6 — Ratios and Proportion</h2>
       <p>Express comparisons as ratios, simplify them, and apply proportion in sharing.</p>`
    ]},
    Thu: { Math: [
      `<h2>CBC Grade 7 Lesson 7 — Algebraic Expressions</h2>
       <p>Use letters to represent numbers, form expressions, and simplify them.</p>`,

      `<h2>CBC Grade 7 Lesson 8 — Solving Simple Equations</h2>
       <p>Apply inverse operations to find unknown values in simple linear equations.</p>`
    ]},
    Fri: { Math: [
      `<h2>CBC Grade 7 Lesson 9 — Geometry</h2>
       <p>Identify and classify different types of angles, triangles, and quadrilaterals.</p>`,

      `<h2>CBC Grade 7 Lesson 10 — Perimeter and Area</h2>
       <p>Calculate perimeter and area of rectangles, squares, and triangles using formulas.</p>`
    ]},
    Sat: { Math: [
      `<span style="color:purple;"><b>Lesson 8: Fractions and Mixed Numbers</b></span><br><br>

<span style="color:green;"><b>Lesson Content:</b></span><br><br>

A <b>fraction</b> represents a part of a whole. It is written as a/b, where 'a' is the numerator and 'b' is the denominator.<br>
A <b>mixed number</b> combines a whole number and a fraction, e.g., 2 1/3.<br><br>

<b>Examples:</b><br>
- Fraction: 3/4 means 3 parts out of 4.<br>
- Mixed number: 1 2/5 = 1 + 2/5.<br><br>

<span style="color:orange;"><b>Question:</b></span><br>
Convert 7/4 into a mixed number.<br><br>

<span style="color:blue;"><b>Final Answer:</b></span><br>
7/4 = 1 3/4.<br>
`,

`<span style="color:purple;"><b>Lesson 9: Decimals and Percentages</b></span><br><br>

<span style="color:green;"><b>Lesson Content:</b></span><br><br>

Decimals are fractions written with a decimal point. Percentages are parts per 100.<br><br>

<b>Examples:</b><br>
- Decimal: 0.75 = 75/100 = 75%<br>
- Percentage: 40% = 40/100 = 0.4<br><br>

<span style="color:orange;"><b>Question:</b></span><br>
Convert 0.65 to a percentage.<br><br>

<span style="color:blue;"><b>Final Answer:</b></span><br>
0.65 = 65%<br>
`,

`<span style="color:purple;"><b>Lesson 10: Algebraic Expressions</b></span><br><br>

<span style="color:green;"><b>Lesson Content:</b></span><br><br>

An <b>algebraic expression</b> is a combination of numbers, variables, and operations.<br>
- Terms are separated by + or - signs.<br>
- Coefficient is the number multiplying a variable.<br><br>

<b>Examples:</b><br>
- 3x + 5y - 7<br>
- -2a + 4b + 6<br><br>

<span style="color:orange;"><b>Question:</b></span><br>
Identify the coefficient of x in 7x - 3y + 5.<br><br>

<span style="color:blue;"><b>Final Answer:</b></span><br>
Coefficient of x = 7.<br>
`,

`<span style="color:purple;"><b>Lesson 11: Solving Linear Equations</b></span><br><br>

<span style="color:green;"><b>Lesson Content:</b></span><br><br>

A linear equation has the form ax + b = c. Solve by isolating x.<br><br>

<b>Examples:</b><br>
- 2x + 5 = 13 → 2x = 8 → x = 4<br>
- 3x - 7 = 8 → 3x = 15 → x = 5<br><br>

<span style="color:orange;"><b>Question:</b></span><br>
Solve: 5x - 10 = 15<br><br>

<span style="color:blue;"><b>Final Answer:</b></span><br>
5x = 25 → x = 5<br>
`,

`<span style="color:purple;"><b>Lesson 12: Geometry – Angles</b></span><br><br>

<span style="color:green;"><b>Lesson Content:</b></span><br><br>

Angles are formed when two rays meet at a vertex.<br>
- Types: acute (<90°), right (90°), obtuse (>90° but <180°), straight (180°).<br><br>

<b>Examples:</b><br>
- A right angle: 90°<br>
- An obtuse angle: 120°<br><br>

<span style="color:orange;"><b>Question:</b></span><br>
Classify an angle of 140°.<br><br>

<span style="color:blue;"><b>Final Answer:</b></span><br>
140° is an obtuse angle.<br>
`,

`<span style="color:purple;"><b>Lesson 13: Perimeter and Area</b></span><br><br>

<span style="color:green;"><b>Lesson Content:</b></span><br><br>

Perimeter is the total length around a shape. Area is the space inside a shape.<br><br>

<b>Examples:</b><br>
- Rectangle: perimeter = 2(l + w), area = l × w<br>
- Triangle: perimeter = sum of sides, area = 1/2 × base × height<br><br>

<span style="color:orange;"><b>Question:</b></span><br>
Find the area of a rectangle with length 8 cm and width 5 cm.<br><br>

<span style="color:blue;"><b>Final Answer:</b></span><br>
Area = 8 × 5 = 40 cm²<br>
`,

`<span style="color:purple;"><b>Lesson 14: Introduction to Statistics</b></span><br><br>

<span style="color:green;"><b>Lesson Content:</b></span><br><br>

Statistics is the study of collecting, organizing, and interpreting data.<br>
- Mean: average value<br>
- Median: middle value<br>
- Mode: most frequent value<br><br>

<b>Examples:</b><br>
- Data: 2, 4, 4, 6, 8 → Mean = (2+4+4+6+8)/5 = 4.8<br>
- Median = 4, Mode = 4<br><br>

<span style="color:orange;"><b>Question:</b></span><br>
Find the mean of 3, 5, 7, 9, 11<br><br>

<span style="color:blue;"><b>Final Answer:</b></span><br>
Mean = (3+5+7+9+11)/5 = 35/5 = 7<br>
`,

      `<h2>CBC Grade 7 Lesson 12 — Mean, Median, and Mode</h2>
       <p>Find mean, median, and mode of given data sets and interpret their meaning.</p>`
    ]}
  },

  8: { // ✅ Grade 8
    Mon: { Math: [
      `<h2>CBC Grade 8 Lesson 1 — Algebra</h2>
       <p>Expand brackets, solve linear equations, and simplify algebraic expressions.</p>`
    ]},
    Tue: { Math: [
      `<h2>CBC Grade 8 Lesson 2 — Geometry</h2>
       <p>Work with angles, triangles, and quadrilaterals using geometric properties.</p>`
    ]},
    Wed: { Math: [
      `<h2>CBC Grade 8 Lesson 3 — Indices & Standard Form</h2>
       <p>Apply laws of indices and write large or small numbers in standard form.</p>`
    ]},
    Thu: { Math: [
      `<h2>CBC Grade 8 Lesson 4 — Statistics</h2>
       <p>Calculate mean, median, mode, and range from data sets.</p>`
    ]},
    Fri: { Math: [
      `<h2>CBC Grade 8 Lesson 5 — Graphs</h2>
       <p>Plot and interpret linear graphs on Cartesian planes.</p>`
    ]},
    Sat: { Math: [
      `<h2>CBC Grade 8 Lesson 6 — Probability</h2>
       <p>Determine likelihoods of outcomes using simple probability.</p>`
    ]}
  },

  9: { // ✅ Grade 9
    Mon: { Math: [
      `<h2>CBC Grade 9 Lesson 1 — Statistics</h2>
       <p>Find mean, median, and mode, and interpret grouped data.</p>`
    ]},
    Tue: { Math: [
      `<h2>CBC Grade 9 Lesson 2 — Algebra</h2>
       <p>Factorize expressions and solve quadratic equations.</p>`
    ]},
    Wed: { Math: [
      `<h2>CBC Grade 9 Lesson 3 — Geometry</h2>
       <p>Apply Pythagoras’ theorem and basic trigonometric ratios.</p>`
    ]},
    Thu: { Math: [
      `<h2>CBC Grade 9 Lesson 4 — Graphs</h2>
       <p>Plot linear and quadratic functions and interpret graphs.</p>`
    ]},
    Fri: { Math: [
      `<h2>CBC Grade 9 Lesson 5 — Probability</h2>
       <p>Understand experimental and theoretical probability.</p>`
    ]},
    Sat: { Math: [
      `<h2>CBC Grade 9 Lesson 6 — Measurement</h2>
       <p>Calculate surface area and volume of solids like prisms and cylinders.</p>`
    ]}
  },

  10: { // ✅ Grade 10
    Mon: { Math: [
      `<h2>CBC Grade 10 Lesson 1 — Algebraic Expressions & Quadratics</h2>
       <p>Expand, simplify, and solve quadratic equations by factorization and formula.</p>`
    ]},
    Tue: { Math: [
      `<h2>CBC Grade 10 Lesson 2 — Trigonometry</h2>
       <p>Use sine, cosine, and tangent to find unknown sides and angles in right triangles.</p>`
    ]},
    Wed: { Math: [
      `<h2>CBC Grade 10 Lesson 3 — Coordinate Geometry</h2>
       <p>Find gradients, midpoints, and distances between points on Cartesian planes.</p>`
    ]},
    Thu: { Math: [
      `<h2>CBC Grade 10 Lesson 4 — Statistics & Data Presentation</h2>
       <p>Represent data using histograms, frequency polygons, and cumulative curves.</p>`
    ]},
    Fri: { Math: [
      `<h2>CBC Grade 10 Lesson 5 — Probability</h2>
       <p>Work with combined events and independent/dependent probabilities.</p>`
    ]},
    Sat: { Math: [
      `<h2>CBC Grade 10 Lesson 6 — Measurement & Scale Drawing</h2>
       <p>Apply scale to drawings and calculate volumes of complex solids.</p>`
    ]}
  },

  11: { // ✅ Grade 11
    Mon: { Math: [
      `<h2>CBC Grade 11 Lesson 1 — Sequences & Series</h2>
       <p>Work with arithmetic and geometric progressions and find nth terms.</p>`
    ]},
    Tue: { Math: [
      `<h2>CBC Grade 11 Lesson 2 — Functions</h2>
       <p>Understand domain, range, and types of functions.</p>`
    ]},
    Wed: { Math: [
      `<h2>CBC Grade 11 Lesson 3 — Differentiation</h2>
       <p>Learn basic differentiation and its applications in gradients and motion.</p>`
    ]},
    Thu: { Math: [
      `<h2>CBC Grade 11 Lesson 4 — Integration</h2>
       <p>Find areas under curves and reverse differentiation.</p>`
    ]},
    Fri: { Math: [
      `<h2>CBC Grade 11 Lesson 5 — Statistics & Probability</h2>
       <p>Analyze distributions and calculate probabilities for multiple events.</p>`
    ]},
    Sat: { Math: [
      `<h2>CBC Grade 11 Lesson 6 — Vectors</h2>
       <p>Represent quantities as vectors and compute magnitude and direction.</p>`
    ]}
  },

  12: { // ✅ Grade 12
    Mon: { Math: [
      `<h2>CBC Grade 12 Lesson 1 — Calculus</h2>
       <p>Apply differentiation and integration to real-world problems.</p>`
    ]},
    Tue: { Math: [
      `<h2>CBC Grade 12 Lesson 2 — Probability Distributions</h2>
       <p>Understand binomial and normal distributions.</p>`
    ]},
    Wed: { Math: [
      `<h2>CBC Grade 12 Lesson 3 — Matrices</h2>
       <p>Perform operations with matrices and find determinants.</p>`
    ]},
    Thu: { Math: [
      `<h2>CBC Grade 12 Lesson 4 — Linear Programming</h2>
       <p>Formulate and solve optimization problems graphically.</p>`
    ]},
    Fri: { Math: [
      `<h2>CBC Grade 12 Lesson 5 — Complex Numbers</h2>
       <p>Represent and operate on complex numbers in Cartesian and polar forms.</p>`
    ]},
    Sat: { Math: [
      `<h2>CBC Grade 12 Lesson 6 — Statistics & Correlation</h2>
       <p>Calculate correlation coefficients and regression lines.</p>`
    ]}
  }
},
  British: {
    7: { // ✅ Year 7
      Mon: { Math: [
        `<h2>British Year 7 — Number Operations</h2><p>Four operations with integers.</p>`
      ]},
      Tue: { Math: [
        `<h2>British Year 7 — Fractions</h2><p>Adding, subtracting, and simplifying fractions.</p>`
      ]},
      Wed: { Math: [
        `<h2>British Year 7 — Decimals</h2><p>Place value, rounding, and decimal operations.</p>`
      ]},
      Thu: { Math: [
        `<h2>British Year 7 — Percentages</h2><p>Percentage change, profit and loss.</p>`
      ]},
      Fri: { Math: [
        `<h2>British Year 7 — Ratio & Proportion</h2><p>Solving word problems on ratios.</p>`
      ]},
      Sat: { Math: [
        `<h2>British Year 7 — Data Handling</h2><p>Bar charts, pie charts, and averages.</p>`
      ]}
    },

    8: { // ✅ Year 8
      Mon: { Math: [
        `<h2>British Year 8 — Algebra Basics</h2><p>Substitution, equations, simple formulae.</p>`
      ]},
      Tue: { Math: [
        `<h2>British Year 8 — Geometry</h2><p>Angles in polygons and parallel lines.</p>`
      ]},
      Wed: { Math: [
        `<h2>British Year 8 — Statistics</h2><p>Collecting data, mean, median, mode.</p>`
      ]},
      Thu: { Math: [
        `<h2>British Year 8 — Graphs</h2><p>Plotting straight-line graphs and coordinates.</p>`
      ]},
      Fri: { Math: [
        `<h2>British Year 8 — Probability</h2><p>Likelihood of events, outcomes.</p>`
      ]},
      Sat: { Math: [
        `<h2>British Year 8 — Measurement</h2><p>Perimeter, area, and volume problems.</p>`
      ]}
    },

    9: { // ✅ Year 9
      Mon: { Math: [
        `<h2>British Year 9 — Geometry</h2><p>Properties of shapes, perimeter, and area.</p>`
      ]},
      Tue: { Math: [
        `<h2>British Year 9 — Algebra</h2><p>Quadratic equations and simultaneous equations.</p>`
      ]},
      Wed: { Math: [
        `<h2>British Year 9 — Trigonometry</h2><p>Sine, cosine, and tangent ratios.</p>`
      ]},
      Thu: { Math: [
        `<h2>British Year 9 — Graphs</h2><p>Linear and quadratic graphing.</p>`
      ]},
      Fri: { Math: [
        `<h2>British Year 9 — Statistics</h2><p>Data presentation and interpretation.</p>`
      ]},
      Sat: { Math: [
        `<h2>British Year 9 — Probability</h2><p>Combined events and experimental probability.</p>`
      ]}
    },

    10: { // ✅ Year 10
      Mon: { Math: [
        `<h2>British Year 10 — Algebraic Manipulation</h2><p>Expand, factorize, and simplify expressions.</p>`
      ]},
      Tue: { Math: [
        `<h2>British Year 10 — Quadratic Equations</h2><p>Factorization, completing the square, and formula method.</p>`
      ]},
      Wed: { Math: [
        `<h2>British Year 10 — Geometry</h2><p>Circle theorems and similarity.</p>`
      ]},
      Thu: { Math: [
        `<h2>British Year 10 — Trigonometry</h2><p>Solving right and non-right triangles.</p>`
      ]},
      Fri: { Math: [
        `<h2>British Year 10 — Statistics</h2><p>Cumulative frequency, box plots, and histograms.</p>`
      ]},
      Sat: { Math: [
        `<h2>British Year 10 — Probability</h2><p>Tree diagrams and independent/dependent events.</p>`
      ]}
    },

    11: { // ✅ Year 11 (IGCSE Level)
      Mon: { Math: [
        `<h2>British Year 11 — Algebra & Functions</h2><p>Composite and inverse functions, inequalities.</p>`
      ]},
      Tue: { Math: [
        `<h2>British Year 11 — Coordinate Geometry</h2><p>Equation of a line, gradients, and intercepts.</p>`
      ]},
      Wed: { Math: [
        `<h2>British Year 11 — Trigonometry</h2><p>Graphing trig functions and solving identities.</p>`
      ]},
      Thu: { Math: [
        `<h2>British Year 11 — Calculus</h2><p>Introduction to differentiation and applications.</p>`
      ]},
      Fri: { Math: [
        `<h2>British Year 11 — Statistics & Probability</h2><p>Interpreting distributions and correlation.</p>`
      ]},
      Sat: { Math: [
        `<h2>British Year 11 — Revision</h2><p>Past paper practice and key formula review.</p>`
      ]}
    },

    12: { // ✅ Year 12 (A-Level)
      Mon: { Math: [
        `<h2>British Year 12 — Pure Mathematics</h2><p>Indices, logarithms, and surds.</p>`
      ]},
      Tue: { Math: [
        `<h2>British Year 12 — Coordinate Geometry</h2><p>Circles, parabolas, and tangents.</p>`
      ]},
      Wed: { Math: [
        `<h2>British Year 12 — Calculus</h2><p>Differentiation and integration applications.</p>`
      ]},
      Thu: { Math: [
        `<h2>British Year 12 — Trigonometry</h2><p>Radians, compound angles, and trig identities.</p>`
      ]},
      Fri: { Math: [
        `<h2>British Year 12 — Probability & Statistics</h2><p>Binomial distribution, normal distribution.</p>`
      ]},
      Sat: { Math: [
        `<h2>British Year 12 — Mechanics</h2><p>Forces, motion, and Newton’s laws.</p>`
      ]}
    }
  },

  CBSE: {
    7: { // ✅ Grade 7
      Mon: { Math: [
        `<h2>CBSE Grade 7 — Integers</h2><p>Positive & negative number practice.</p>`
      ]},
      Tue: { Math: [
        `<h2>CBSE Grade 7 — Fractions & Decimals</h2><p>Operations with fractions and decimals.</p>`
      ]},
      Wed: { Math: [
        `<h2>CBSE Grade 7 — Data Handling</h2><p>Collecting, organizing, and interpreting data.</p>`
      ]},
      Thu: { Math: [
        `<h2>CBSE Grade 7 — Simple Equations</h2><p>Forming and solving simple linear equations.</p>`
      ]},
      Fri: { Math: [
        `<h2>CBSE Grade 7 — Lines & Angles</h2><p>Types of lines and angle relationships.</p>`
      ]},
      Sat: { Math: [
        `<h2>CBSE Grade 7 — Perimeter & Area</h2><p>Finding perimeter and area of basic shapes.</p>`
      ]}
    },

    8: { // ✅ Grade 8
      Mon: { Math: [
        `<h2>CBSE Grade 8 — Algebra</h2><p>Expanding brackets, solving equations.</p>`
      ]},
      Tue: { Math: [
        `<h2>CBSE Grade 8 — Rational Numbers</h2><p>Operations and properties of rational numbers.</p>`
      ]},
      Wed: { Math: [
        `<h2>CBSE Grade 8 — Comparing Quantities</h2><p>Ratios, percentages, and profit & loss.</p>`
      ]},
      Thu: { Math: [
        `<h2>CBSE Grade 8 — Geometry</h2><p>Congruence, polygons, and quadrilaterals.</p>`
      ]},
      Fri: { Math: [
        `<h2>CBSE Grade 8 — Mensuration</h2><p>Surface area and volume of solids.</p>`
      ]},
      Sat: { Math: [
        `<h2>CBSE Grade 8 — Data Handling</h2><p>Bar graphs, pie charts, and probability basics.</p>`
      ]}
    },

    9: { // ✅ Grade 9
      Mon: { Math: [
        `<h2>CBSE Grade 9 — Geometry</h2><p>Angles in triangles, quadrilaterals.</p>`
      ]},
      Tue: { Math: [
        `<h2>CBSE Grade 9 — Polynomials</h2><p>Types of polynomials and their operations.</p>`
      ]},
      Wed: { Math: [
        `<h2>CBSE Grade 9 — Coordinate Geometry</h2><p>Plotting points, distance formula.</p>`
      ]},
      Thu: { Math: [
        `<h2>CBSE Grade 9 — Linear Equations in Two Variables</h2><p>Graphical and algebraic solutions.</p>`
      ]},
      Fri: { Math: [
        `<h2>CBSE Grade 9 — Statistics</h2><p>Mean, median, mode, and graphical representation.</p>`
      ]},
      Sat: { Math: [
        `<h2>CBSE Grade 9 — Probability</h2><p>Basic concepts of chance and outcomes.</p>`
      ]}
    },

    10: { // ✅ Grade 10
      Mon: { Math: [
        `<h2>CBSE Grade 10 — Real Numbers</h2><p>Euclid’s division lemma and HCF/LCM concepts.</p>`
      ]},
      Tue: { Math: [
        `<h2>CBSE Grade 10 — Polynomials</h2><p>Zeros of polynomials and their relationships.</p>`
      ]},
      Wed: { Math: [
        `<h2>CBSE Grade 10 — Pair of Linear Equations</h2><p>Solving equations using substitution and elimination.</p>`
      ]},
      Thu: { Math: [
        `<h2>CBSE Grade 10 — Quadratic Equations</h2><p>Solving by factorization and formula.</p>`
      ]},
      Fri: { Math: [
        `<h2>CBSE Grade 10 — Arithmetic Progressions</h2><p>General term and sum of n terms.</p>`
      ]},
      Sat: { Math: [
        `<h2>CBSE Grade 10 — Trigonometry</h2><p>Trigonometric ratios, identities, and applications.</p>`
      ]}
    },

    11: { // ✅ Grade 11
      Mon: { Math: [
        `<h2>CBSE Grade 11 — Sets & Relations</h2><p>Union, intersection, and Cartesian products.</p>`
      ]},
      Tue: { Math: [
        `<h2>CBSE Grade 11 — Trigonometric Functions</h2><p>Graphs and identities of trigonometric functions.</p>`
      ]},
      Wed: { Math: [
        `<h2>CBSE Grade 11 — Complex Numbers</h2><p>Representation and operations of complex numbers.</p>`
      ]},
      Thu: { Math: [
        `<h2>CBSE Grade 11 — Quadratic Equations</h2><p>Nature of roots and solving equations.</p>`
      ]},
      Fri: { Math: [
        `<h2>CBSE Grade 11 — Straight Lines</h2><p>Equation, slope, and distance formula.</p>`
      ]},
      Sat: { Math: [
        `<h2>CBSE Grade 11 — Statistics</h2><p>Measures of dispersion and correlation.</p>`
      ]}
    },

    12: { // ✅ Grade 12
      Mon: { Math: [
        `<h2>CBSE Grade 12 — Relations & Functions</h2><p>Types of relations, domain, and range.</p>`
      ]},
      Tue: { Math: [
        `<h2>CBSE Grade 12 — Inverse Trigonometric Functions</h2><p>Properties and principal values.</p>`
      ]},
      Wed: { Math: [
        `<h2>CBSE Grade 12 — Matrices</h2><p>Matrix addition, multiplication, and inverse.</p>`
      ]},
      Thu: { Math: [
        `<h2>CBSE Grade 12 — Determinants</h2><p>Properties and applications in solving equations.</p>`
      ]},
      Fri: { Math: [
        `<h2>CBSE Grade 12 — Continuity & Differentiability</h2><p>Basic rules and derivative applications.</p>`
      ]},
      Sat: { Math: [
        `<h2>CBSE Grade 12 — Integrals</h2><p>Indefinite and definite integrals with applications.</p>`
      ]}
    }
  }
};


/* ---------- Timetables ---------- */
const timetables = {
  CBC: {
    Mon: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Tue: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Wed: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Thu: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Fri: [{ subject: "Math", start: "17:00", end: "19:00" }],
    Sat: [{ subject: "Math", start: "08:00", end: "19:00" }],
    Sun: []
  },
  British: {
    Mon: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Tue: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Wed: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Thu: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Fri: [{ subject: "Math", start: "17:00", end: "19:00" }],
    Sat: [{ subject: "Math", start: "08:00", end: "19:00" }],
    Sun: []
  },
  CBSE: {
    Mon: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Tue: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Wed: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Thu: [{ subject: "Math", start: "17:30", end: "19:00" }],
    Fri: [{ subject: "Math", start: "17:00", end: "19:00" }],
    Sat: [{ subject: "Math", start: "08:00", end: "19:00" }],
    Sun: []
  }
};

/* ---------- Time Checker ---------- */
function inTimeRange(start, end, now) {
  const [sH, sM] = start.split(":").map(Number);
  const [eH, eM] = end.split(":").map(Number);
  const s = new Date(now), e = new Date(now);
  s.setHours(sH, sM, 0, 0);
  e.setHours(eH, eM, 0, 0);
  return now >= s && now <= e;
}

/* ---------- Voice ---------- */
function getVoice() {
  const voices = speechSynthesis.getVoices();
  return voices.find(v => v.lang.startsWith("en-ke") && v.name.toLowerCase().includes("female"))
      || voices.find(v => v.lang.startsWith("en-gb"))
      || voices[0];
}

function speak(html) {
  const text = new DOMParser().parseFromString(html, "text/html").body.textContent;
  speechSynthesis.cancel();
  utter = new SpeechSynthesisUtterance(text);
  utter.voice = selectedVoice;
  utter.rate = 0.85;
  speechSynthesis.speak(utter);
}


/* ---------- App Features ---------- */
const appFeatures = [
  "🎓 Affordable Live Online Tuition – From just Ksh 200 per hour",
  "👩‍🏫 Live group tuition with real tutors from top Kenyan schools",
  "🤖 FREE AI-Powered Virtual Tutor – 24/7 homework & exam help",
  "📲 Connect with nearby tutors for physical or online tuition",
  "📝 On-Demand Homework Help with AI + human tutors",
  "💬 Free student academic chats & forums across Kenya",
  "📚 Access 2000+ Video Lessons & 5000+ Quizzes",
  "📖 30,000+ CBC, IGCSE & KCSE Past Papers with Answers",
  "📘 200+ Ebooks for Primary & Secondary Students",
  "🏆 Weekly National Tests & Digital Certificates",
  "❓ 1000+ Question & Answer Pairs from Past Exams",
  "🎮 3 Fun Math Games & 3 Kiswahili/English Language Games",
  "🌍 Career Guidance Tools for Kenyan Teens",
  "🗓️ AI-Powered Study Timetable Generator",
  "📝 Digital Notebook, Notes Organizer & Revision Tracker",
  "🧮 Scientific Calculator + Graph Plotting Tools",
  "🔢 Math, Chemistry & Physics Formula Tools",
  "📖 Digital Dictionary & Kiswahili Kamusi",
  "💡 Similes, Metaphors, Methali & Nahau Reference Tools",
  "🧍‍♂️ Human, Fish & Plant 3D Anatomy Simulators",
  "🧪 Interactive Digital Periodic Table",
  "⚛️ Physics Concepts & Mole Calculators",
  "🧬 Chemical Equations Balancer + Organic Chemistry Guide",
  "📐 Math Tools: Area, Volume, Trigonometry, Logarithms",
  "💰 Financial Math Tools: Tax, Interest, Binomial, Variation",
  "🗺️ Geography Tools: Latitude/Longitude, Errors & Approximations",
  "📊 Advanced Statistics & Matrix Solvers",
  "➗ Calculus: Differentiation & Integration Calculators"
];

/* ---------- Start Tutor ---------- */
function startTutor() {
  if (!selectedCurriculum || !selectedGrade) {
    alert("⚠️ Please choose both curriculum and grade first!");
    return;
  }

  selectedVoice = getVoice();

  const now = new Date();
  const kenyaTime = new Date(now.toLocaleString("en-US", { timeZone: "Africa/Nairobi" }));
  const dayNames = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
  const today = dayNames[kenyaTime.getDay()];

  todayLessons = lessonsArray[selectedCurriculum]?.[selectedGrade]?.[today]?.Math || [];
  const todaySchedule = timetables[selectedCurriculum]?.[today] || [];
  const status = document.getElementById("status");

  // Hide main card
  const mainCard = document.querySelector("#editor .card");
  if (mainCard) mainCard.style.display = "none";

  // Create lesson section
  let lessonSection = document.getElementById("lessonSection");
  if (!lessonSection) {
    lessonSection = document.createElement("div");
    lessonSection.id = "lessonSection";
    lessonSection.style.width = "100%";
    lessonSection.style.marginTop = "16px";
    document.getElementById("editor").appendChild(lessonSection);
  }

  // Check if we are in a Math lesson slot
  const inLesson = todaySchedule.some(slot => inTimeRange(slot.start, slot.end, kenyaTime) && slot.subject === "Math");

  if (!inLesson) {
    const upcoming = todaySchedule.filter(slot => slot.subject === "Math").map(s => `${s.start} – ${s.end}`);
    const nextLessonTime = upcoming.length ? upcoming.join(", ") : "No more lessons today.";

    lessonSection.innerHTML = `
      <div class="card" style="text-align:center; color:#d32f2f;">
        <h2>⏰ No active Math lesson right now.</h2>
        <p>Next lesson: ${nextLessonTime}</p>
      </div>`;
    status.textContent = "🕓 Waiting for next lesson...";
    return;
  }

  if (todayLessons.length === 0) {
    lessonSection.innerHTML = `
      <div class="card" style="text-align:center;">
        📘 No Math lesson found for today.
      </div>`;
    status.textContent = "ℹ️ No lessons for today.";
    return;
  }

  currentLesson = 0;
  showLesson();
  status.textContent = `🎓 Showing lesson ${currentLesson + 1} of ${todayLessons.length}`;

  if (!lessonIntervalId) lessonIntervalId = setInterval(startTutor, 60 * 1000);
}

/* ---------- Show and Speak Current Lesson ---------- */
function showLesson() {
  const lessonSection = document.getElementById("lessonSection");
  lessonSection.innerHTML = "";

  if (currentLesson >= todayLessons.length) {
    lessonSection.innerHTML = `
      <div class="card">
        <h2>✅ All lessons for this slot are done!</h2>
        <p>Keep learning with <b>Smart Tutor by Elimu Connect</b>.</p>
      </div>`;
    return;
  }

  const lessonHTML = todayLessons[currentLesson];

  // Lesson card
  const card = document.createElement("div");
  card.className = "card";
  card.style.marginTop = "12px";
  card.innerHTML = `
    <h3 style="margin-top:0">${selectedCurriculum} – Grade ${selectedGrade} Math Lesson ${currentLesson + 1}</h3>
    ${lessonHTML}
    <hr>
    <div style="margin-top:10px; background:#f0f8ff; padding:10px; border-radius:10px; font-size:0.95em;">
      <b>📲 More with Elimu Connect/SmartLearn App:</b>
      <ul style="margin:8px 0 0 20px;">
        <li>${appFeatures[featureIndex % appFeatures.length]}</li>
        <li>${appFeatures[(featureIndex + 1) % appFeatures.length]}</li>
        <li>${appFeatures[(featureIndex + 2) % appFeatures.length]}</li>
      <li>${appFeatures[(featureIndex + 3) % appFeatures.length]}</li>
        <li>${appFeatures[(featureIndex + 4) % appFeatures.length]}</li>
        <li>${appFeatures[(featureIndex + 5) % appFeatures.length]}</li>
        
        
      </ul>
      <a href="https://play.google.com/store/apps/details?id=elimuconnect.tuitioncentre" target="_blank" style="display:inline-block; margin-top:8px;">
        <button style="background:#28a745;color:white;padding:8px 12px;border:none;border-radius:6px;cursor:pointer;font-size:14px;">
          🚀 Install App
        </button>
      </a>
    </div>
    <div style="margin-top:10px; text-align:center;">
      <button id="nextLessonBtn" style="padding:6px 12px; border:none; border-radius:6px; background:#1976d2; color:white; cursor:pointer;">
        ➡️ Next Lesson
      </button>
    </div>
  `;
  lessonSection.appendChild(card);
  featureIndex += 3;

  // Speak lesson
  if (speechSynthesis.speaking) speechSynthesis.cancel();
  const tmp = document.createElement("div");
  tmp.innerHTML = lessonHTML;
  const utter = new SpeechSynthesisUtterance(tmp.textContent);
  utter.rate = 0.8;
  utter.voice = selectedVoice;
  speechSynthesis.speak(utter);

 document.getElementById("nextLessonBtn").onclick = () => {
  currentLesson++;

  if (currentLesson >= todayLessons.length) {
    // Show "All lessons done" card
    showLesson();
    document.getElementById("status").textContent = "🎓 All lessons done for this slot";
    return;
  }

  // Otherwise, show next lesson
  showLesson();
  document.getElementById("status").textContent = `🎓 Showing lesson ${currentLesson + 1} of ${todayLessons.length}`;
};

}


// Realtime Database reference
const db = firebase.database();

const ratingStars = document.querySelectorAll(".rating span");
const avgRatingEl = document.getElementById("avgRating");

// Add a container for the delayed message
let ratingTimeout;
let ratingMessage = document.getElementById("ratingMessage");
if (!ratingMessage) {
  ratingMessage = document.createElement("div");
  ratingMessage.id = "ratingMessage";
  ratingMessage.style.cssText = `
    display:none; 
    color:#388e3c; 
    font-weight:bold; 
    margin-bottom:10px; 
    opacity:0; 
    transform:translateY(-10px); 
    transition: all 0.5s ease;
  `;
  document.querySelector(".card").prepend(ratingMessage);
}

// --- Visual star update (clicked/persisted) --- //
function updateStars(val) {
  ratingStars.forEach(s => {
    s.classList.remove("active");
    if (parseInt(s.dataset.v) <= val) {
      s.classList.add("active");
    }
  });
}

// --- Function to update average rating live --- //
function updateAverageRating() {
  db.ref("ratings").on("value", snapshot => {
    let total = 0, count = 0;
    snapshot.forEach(child => {
      total += child.val().rating;
      count++;
    });

    const avg = count ? (total / count).toFixed(1) : 0;

    // Update the display with average and number of ratings
    avgRatingEl.textContent = count 
      ? `${avg} (${count} students)` 
      : "No ratings yet";
  });
}

// Call it once to start listening for live updates
updateAverageRating();

// --- Hover preview only --- //
ratingStars.forEach(star => {
  star.addEventListener("mouseover", () => {
    const val = parseInt(star.dataset.v);
    ratingStars.forEach(s => {
      s.classList.toggle("hover", parseInt(s.dataset.v) <= val);
    });
  });

  star.addEventListener("mouseout", () => {
    ratingStars.forEach(s => s.classList.remove("hover"));
    if (user) {
      db.ref("students/" + user.uid).once("value", snap => {
        const val = snap.exists() ? snap.val().rating : 0;
        updateStars(val);
      });
    } else {
      updateStars(0); // keep gray when not logged in
    }
  });
});

// --- Click events to save rating --- //
ratingStars.forEach(star => {
  star.addEventListener("click", async () => {
    if (!user) return alert("⚠️ Login first to save rating.");
    const val = parseInt(star.dataset.v);

    // Save/update user's rating inside student profile
    await db.ref("students/" + user.uid).update({
      name: user.displayName,
      email: user.email,
      rating: val,
      ratingTimestamp: Date.now()
    });

    // Also save/update inside ratings node for averaging
    await db.ref("ratings/" + user.uid).set({
      rating: val,
      timestamp: Date.now()
    });

    // Update stars visually for this user
    updateStars(val);

    // Clear previous timeout if any
    if (ratingTimeout) clearTimeout(ratingTimeout);

    // Delay message 5 seconds
    ratingTimeout = setTimeout(() => {
      ratingMessage.textContent = `Thanks! You rated ${val}⭐`;
      ratingMessage.style.display = "block";
      setTimeout(() => {
        ratingMessage.style.opacity = 1;
        ratingMessage.style.transform = "translateY(0)";
      }, 10);

      // Fade out after 3s
      setTimeout(() => {
        ratingMessage.style.opacity = 0;
        ratingMessage.style.transform = "translateY(-10px)";
        setTimeout(() => { ratingMessage.style.display = "none"; }, 500);
      }, 3000);

      ratingTimeout = null;
    }, 5000);
  });
});

// --- Restore student’s rating after login --- //
auth.onAuthStateChanged(u => {
  user = u;
  if (user) {
    db.ref("ratings/" + user.uid).once("value", snap => {
      if (snap.exists()) updateStars(snap.val().rating);
      else updateStars(0);
    });
  } else {
    updateStars(0);
  }
});



  
function savePhoneNumber() {
  const phone = document.getElementById("phoneInput").value.trim();
  if (!phone) {
    alert("⚠️ Please enter your phone number.");
    return;
  }

  db.ref("students/" + user.uid).update({
    phone: phone,
    timestamp: Date.now()
  }).then(() => {
    alert("✅ Phone number saved! Lessons unlocked.");
    document.getElementById("phoneForm").style.display = "none";
    document.querySelector(".card").style.display = "block";
    editor.scrollIntoView({behavior: "smooth"});
  });
}




function prevLesson(){
  if(todayLessons.length && currentLesson>0){
    currentLesson--;
    showLesson();
  }
}
function nextLesson(){
  if(todayLessons.length && currentLesson<todayLessons.length-1){
    currentLesson++;
    showLesson();
  }
}
function pauseTutor(){speechSynthesis.pause();status.textContent="⏸️ Paused";}
function resumeTutor(){speechSynthesis.resume();status.textContent="▶️ Resumed";}
function contactWhatsApp(){window.open("https://wa.me/254769255782","_blank");}



function saveLessonRequest() {
  if (!user) {
    alert("⚠️ Please login first to request a lesson.");
    return;
  }

  const requestText = document.getElementById("lessonRequest").value.trim();
  const statusEl = document.getElementById("requestStatus");

  if (!requestText) {
    statusEl.textContent = "❌ Please type your lesson request before submitting.";
    statusEl.style.color = "red";
    return;
  }

  // Save request under student node → append new requests
  const requestsRef = db.ref("students/" + user.uid + "/requests").push();

  requestsRef.set({
    text: requestText,
    timestamp: Date.now()
  }).then(() => {
    statusEl.textContent = "✅ Your request has been saved!";
    statusEl.style.color = "green";
    document.getElementById("lessonRequest").value = "";
  }).catch(err => {
    statusEl.textContent = "❌ Error: " + err.message;
    statusEl.style.color = "red";
  });
}
    
</script>
</body>
</html>
