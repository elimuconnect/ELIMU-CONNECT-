<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Elimu Connect - Access</title>
<style>
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  background: linear-gradient(135deg, #6DD5FA, #2980B9);
  flex-direction: column;
  margin: 0;
}

.login-container {
  background: #ffffffcc;
  padding: 35px 30px;
  border-radius: 20px;
  text-align: center;
  width: 320px;
  margin: 15px 0;
  box-shadow: 0 15px 30px rgba(0,0,0,0.2);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.login-container:hover {
  transform: translateY(-5px);
  box-shadow: 0 25px 40px rgba(0,0,0,0.3);
}

.login-container h3 {
  font-size: 1.6rem;
  margin-bottom: 20px;
  color: #333;
  text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
}

button {
  padding: 14px 24px;
  margin: 10px 0;
  font-size: 16px;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  color: white;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

button:hover {
  transform: scale(1.05);
  box-shadow: 0 8px 15px rgba(0,0,0,0.2);
}

button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Student Button */
#studentBtn {
  background: linear-gradient(135deg, #ff758c, #ff7eb3);
  box-shadow: 0 5px 15px rgba(255, 120, 180, 0.4);
}
/* Parent Button */
.login-container:nth-child(2) button {
  background: linear-gradient(135deg, #2ecc71, #27ae60); /* darker green gradient */
  color: white; /* ensures text is visible */
  box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4);
}



/* Countdown */
#accessCountdown {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: linear-gradient(135deg, #ffb347, #ffcc33);
  color: #333;
  font-weight: bold;
  padding: 12px 25px;
  border-radius: 12px;
  display: none;
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
  text-align: center;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

/* Modal */
#accessModal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.7);
  display: flex;
  justify-content: center;
  align-items: center;
  display: none;
  z-index: 9999;
  backdrop-filter: blur(4px);
}

#accessModal div {
  background: #ffffffee;
  padding: 30px 25px;
  border-radius: 20px;
  max-width: 380px;
  text-align: center;
  box-shadow: 0 20px 40px rgba(0,0,0,0.2);
  animation: fadeIn 0.4s ease-out;
}

#accessModal button {
  background: #ff6a00;
  color: white;
  padding: 12px 20px;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  font-weight: bold;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

#accessModal button:hover {
  transform: scale(1.05);
  box-shadow: 0 6px 12px rgba(255,106,0,0.4);
}

/* Fade-in animation for modal */
@keyframes fadeIn {
  from {opacity: 0; transform: translateY(-20px);}
  to {opacity: 1; transform: translateY(0);}
}
</style>

<body>
<div class="login-container">
  <h3>üéì Student</h3>
  <button id="studentBtn">üìöEnter (Free Trial / Pro Access)</button>
</div>

<div class="login-container">
  <h3>üë®‚Äçüë©‚Äçüëß Parent</h3>
  <button onclick="window.location.href='go:parent'">Parent Dashboard </button>
</div>

<div id="accessCountdown">Loading access info...</div>

<div id="accessModal">
  <div>
    <p id="accessMessage"></p>
    <button id="accessBtn">OK</button>
  </div>
</div>



<script>
const PAYMENT_LINK = "https://paystack.shop/pay/2i-azr3wzx";

// 24h trial and 30 days paid access in milliseconds
const FIRST_TRIAL_MS = 8 * 60 * 60 * 1000; 
const PAID_DURATION_MS = 30 * 24 * 60 * 60 * 1000;

const KEY = "elimu_student_simple2_";

// UI
const mainBtn = document.getElementById("studentBtn");
const countdownEl = document.getElementById("accessCountdown");
const modal = document.getElementById("accessModal");
const modalMsg = document.getElementById("accessMessage");
const modalBtn = document.getElementById("accessBtn");

// Helpers
function now(){ return Date.now(); }

function format(ms){
    if(ms <= 0) return "00:00:00:00";
    let s = Math.floor(ms/1000);
    let days = Math.floor(s / 86400); // 24*3600
    s %= 86400;
    let h = Math.floor(s / 3600);
    s %= 3600;
    let m = Math.floor(s / 60);
    s %= 60;
    return `${days}d ${String(h).padStart(2,'0')}h:${String(m).padStart(2,'0')}m:${String(s).padStart(2,'0')}s`;
}

function showModal(msg, btn="OK", cb=null){
    modalMsg.innerHTML = msg;
    modalBtn.textContent = btn;
    modal.style.display = "flex";
    modalBtn.onclick = ()=>{
        modal.style.display="none";
        if(cb) cb();
    };
}

// --------------------- STORAGE ---------------------
let paidUntil = parseInt(localStorage.getItem(KEY+"paidUntil")) || 0;
let paidRef = localStorage.getItem(KEY+"paidReference") || "";
let firstTrialEnd = parseInt(localStorage.getItem(KEY+"firstTrialEnd")) || 0;

// ------------------- HANDLE PAYMENT -------------------
const reference = new URLSearchParams(location.search).get("reference");
if(reference && reference !== paidRef){
    paidRef = reference;
    paidUntil = now() + PAID_DURATION_MS;

    localStorage.setItem(KEY+"paidReference", paidRef);
    localStorage.setItem(KEY+"paidUntil", paidUntil);

    // Remove trial
    localStorage.removeItem(KEY+"firstTrialEnd");
    firstTrialEnd = 0;
}

// ------------------ FIRST TRIAL ------------------
if(!firstTrialEnd){
    firstTrialEnd = now() + FIRST_TRIAL_MS;
    localStorage.setItem(KEY+"firstTrialEnd", firstTrialEnd);
}

// ---------------- COUNTDOWN ENGINE ----------------
function engine(){
    countdownEl.style.display = "block";
    setInterval(()=>{
        const t = now();

        if(t < paidUntil){
            countdownEl.textContent = "Paid access: " + format(paidUntil - t);
            mainBtn.disabled = false;
            return;
        }

        if(t < firstTrialEnd){
            countdownEl.textContent = "Free trial: " + format(firstTrialEnd - t);
            mainBtn.disabled = false;
            return;
        }

        // LOCK ACCESS
        countdownEl.style.display = "none";
        mainBtn.disabled = true;
        showModal(
            "üöÄ Your journey to success shouldn't stop here! Unlock 30 Days of AI tutor for exam prep, homework help, quizzes past papers, and STEM labs for just $0.15/KSh 20.",
            "Unlock Monthly Pass ‚Äî $4.7/KSh 600.",
            ()=> location.href = PAYMENT_LINK
        );
    }, 500);
}

engine();

// ------------------ BUTTON CLICK ------------------
mainBtn.onclick = ()=>{
    const t = now();
    if(t < paidUntil || t < firstTrialEnd) return location.href = "go:bot1";

    showModal(
        "üöÄ Your journey to success shouldn't stop here! Unlock 30 Days of AI tutor for exam prep, homework help, quizzes past papers, and STEM labs for just $0.15/KSh 20.",
        "Unlock Monthly Pass ‚Äî $4.7/KSh 600.",
        ()=> location.href = PAYMENT_LINK
    );
};
</script>
</body>
</html>
