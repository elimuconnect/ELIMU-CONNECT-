<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Elimu Connect Payments</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 600px;
      margin: auto;
    }
    section {
      margin-bottom: 30px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
    }
    h2, h3 {
      text-align: center;
    }
    input, button, select {
      padding: 10px;
      margin: 8px 0;
      width: 100%;
    }
    button {
      background-color: #28a745;
      color: white;
      border: none;
      font-weight: bold;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h2>üéâ Elimu Connect Referrals & Payments</h2>

  <!-- SECTION 1: How to Pay -->
  <section>
    <h3>üí≥ How to Pay</h3>
    <select id="region" onchange="toggleInstructions()">
      <option value="">-- Select Your Region --</option>
      <option value="kenya">Kenya (MPesa)</option>
      <option value="international">International (PayPal, Remitly, Wise, Western Union)</option>
    </select>

    <!-- Kenya Payment Instructions -->
    <div id="instructions-kenya" style="display:none;">
      <p><strong>Kenya Students:</strong> Pay via MPesa to:</p>
     
      <img
        src="https://res.cloudinary.com/dwvt4e9o2/image/upload/v1753469056/ChatGPT_Image_Jul_25_2025_08_38_48_PM_dehdsv.png"
        alt="MPesa Payment Instructions"
        style="width:100%; border:1px solid #ddd; border-radius:8px;"
      />
    </div>

    <!-- International Payment Instructions -->
    <div id="instructions-international" style="display:none;">
      <p><strong>International Students:</strong> You can pay using:</p>
      <ul>
        <li>1Ô∏è‚É£ PayPal ‚Üí <b>wamithisolomon@gmail.com</b></li>
        <li>2Ô∏è‚É£ Remitly, WorldRemit, Wise, or Western Union ‚Üí Send to MPesa:</li>
      </ul>
      <p>Phone: <b>+254769255782</b><br/>Name: <b>Solomon Ndegwa Wamithi</b></p>
    </div>
  </section>

  <!-- SECTION 2: Confirm Payment -->
  <section>
    <h3>‚úÖ Confirm Your Payment</h3>

    <!-- Kenya Payment Form -->
    <form id="form-kenya" style="display:none;">
      <input type="text" id="name-ke" placeholder="Your Name" required />
      <input type="text" id="phone-ke" placeholder="Phone Number" required />
      <input type="text" id="mpesa" placeholder="MPesa Transaction Code" required />
      <button type="button" onclick="submitPaymentProof('kenya')">Submit Kenya Payment</button>
    </form>

    <!-- International Payment Form -->
    <form id="form-international" style="display:none;">
      <input type="text" id="name-int" placeholder="Your Name" required />
      <input type="email" id="email-int" placeholder="Email Used in Payment" required />
      <input type="text" id="country-int" placeholder="Your Country" required />
      <input type="text" id="txid-int" placeholder="Transaction ID (Last 4 digits)" required />
      <button type="button" onclick="submitPaymentProof('international')">Submit International Payment</button>
    </form>
  </section>

<script>
  // Toggle instructions & forms
  function toggleInstructions() {
    const region = document.getElementById("region").value;
    document.getElementById("instructions-kenya").style.display = (region === "kenya") ? "block" : "none";
    document.getElementById("instructions-international").style.display = (region === "international") ? "block" : "none";
    document.getElementById("form-kenya").style.display = (region === "kenya") ? "block" : "none";
    document.getElementById("form-international").style.display = (region === "international") ? "block" : "none";
  }

  // Save referral code if present
  window.addEventListener("DOMContentLoaded", function () {
    const params = new URLSearchParams(window.location.search);
    const ref = params.get("ref");
    if (ref) localStorage.setItem("referral_code", ref);
  });

  // Submit payment proof
  function submitPaymentProof(region) {
    const referral = localStorage.getItem("referral_code") || "none";
    let data = {};
    let message = "";

    if (region === "kenya") {
      const name = document.getElementById("name-ke").value.trim();
      const phone = document.getElementById("phone-ke").value.trim();
      const mpesaCode = document.getElementById("mpesa").value.trim();
      if (!name || !phone || !mpesaCode) return alert("Fill all MPesa details.");

      data = { 
        region: "Kenya", 
        name, 
        phone, 
        mpesaCode, 
        referral, 
        timestamp: new Date().toISOString() 
      };

      // Kenya WhatsApp message
      message = `NEW PAYMENT üöÄ\nRegion: Kenya\nName: ${name}\nPhone: ${phone}\nMPesa Code: ${mpesaCode}\nReferral: ${referral}`;

    } else {
      const name = document.getElementById("name-int").value.trim();
      const email = document.getElementById("email-int").value.trim();
      const country = document.getElementById("country-int").value.trim();
      const txid = document.getElementById("txid-int").value.trim();
      if (!name || !email || !country || !txid) return alert("Fill all international details.");

      data = { 
        region: "International", 
        name, 
        email, 
        country, 
        txid, 
        referral, 
        timestamp: new Date().toISOString() 
      };

      // International WhatsApp message
      message = `NEW PAYMENT üöÄ\nRegion: International\nName: ${name}\nEmail: ${email}\nCountry: ${country}\nTransaction ID: ${txid}\nReferral: ${referral}`;
    }

    // Save in Firebase
    fetch("https://tutor-students-mapping-default-rtdb.firebaseio.com/referrals.json", {
      method: "POST",
      body: JSON.stringify(data)
    }).then(() => {
      const encoded = encodeURIComponent(message);
      window.location.href = `https://wa.me/254769255782?text=${encoded}`;
    });
  }
</script>

  
 
</body>
</html>
